<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <title>Drawcaster - Solana Pixel War</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
  <style>
    :root {
      --farcaster-purple: #7c65c1;
      --farcaster-light-purple: #9a86d4;
      --farcaster-dark-purple: #5a4a8a;
      --accent-yellow: #FFD700;
      --background-dark: #1a1a2e;
      --background-light: #f8f9ff;
      --text-light: #ffffff;
      --text-dark: #2d2d44;
      --grid-bg: #2d2d44;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      user-select: none;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
      color: white;
      background: linear-gradient(135deg, var(--background-dark), var(--farcaster-dark-purple)); /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–æ–Ω */
      height: 100vh;
      overflow: auto;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .graffiti-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      opacity: 0.1;
    }

    .graffiti-text {
      position: absolute;
      color: white;
      font-family: 'Inter', sans-serif;
      font-weight: bold;
      transform-origin: center;
      text-shadow: 0 0 10px rgba(124, 101, 193, 0.3);
    }

    .app-container {
      position: relative;
      z-index: 1;
      max-width: 424px;
      max-height: 695px;
      margin: 0 auto;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      background: rgba(255, 255, 255, 0.05); /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
      backdrop-filter: blur(10px); /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–∞–∑–º—ã—Ç–∏–µ —Ñ–æ–Ω–∞ */
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–µ–Ω—å */
      border: 1px solid rgba(255, 255, 255, 0.1);
      /* border-bottom: 5px solid var(--background-dark); */ /* –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É */
      /* box-shadow: inset 0 -10px 10px -5px var(--background-dark); */ /* –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Ç–µ–Ω—å */
    }
    
    .graffiti-corners {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 2;
    }
    .graffiti-draw {
      position: absolute;
      color: white;
      font-family: 'Inter', sans-serif;
      font-weight: bold;
      opacity: 0.13;
      text-shadow: 0 0 10px #7c65c1;
      user-select: none;
      pointer-events: none;
      white-space: nowrap;
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: rgba(124, 101, 193, 0.2);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .app-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      font-size: 1.2rem;
    }
    
    .app-title span {
      background: linear-gradient(90deg, var(--farcaster-purple), white, var(--farcaster-purple));
      background-size: 200% 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientFlow 3s linear infinite;
    }

    .app-title svg {
      /* Keep this for general SVG styles if needed, like margin */
      /* Removed any conflicting CSS styles */
      background: var(--background-dark); /* Background color for the grid lines */
      animation: none; /* Ensure no animation from CSS on the svg element itself */
    }

    .app-title svg path, .app-title svg rect {
       /* Ensure fill is set by url(#gradient) in SVG */
       /* Removed fill: none; */
       stroke: none; /* Ensure no stroke is applied by CSS, gaps create the grid */
    }

    @keyframes gradientFlow {
      0% {
        background-position: 0% 50%;
      }
      100% {
        background-position: 200% 50%;
      }
    }

    @keyframes gradientMove {
      0% {
        transform: translateX(-100%);
      }
      100% {
        transform: translateX(100%);
      }
    }
    
    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(45deg, var(--farcaster-purple), var(--accent-yellow));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      font-size: 16px;
    }
    
    .leaderboard-btn {
      background: var(--farcaster-purple);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .leaderboard-btn:hover {
      background: var(--farcaster-light-purple);
      transform: translateY(-2px);
    }
    
    .music-control {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.15);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      position: relative;
      overflow: hidden;
    }
    
    .music-control:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: scale(1.05);
    }
    
    .music-control.playing {
      background: #1a1a2e;
      color: transparent;
    }

    .music-control.playing::before {
      content: 'üê±';
      position: absolute;
      font-size: 20px;
      animation: nyanCat 0.8s steps(4) infinite;
      transform-origin: center;
      z-index: 2;
    }

    .music-control.playing::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        linear-gradient(90deg, 
          #ff0000 0%, #ff0000 14.28%,
          #ff7f00 14.28%, #ff7f00 28.57%,
          #ffff00 28.57%, #ffff00 42.85%,
          #00ff00 42.85%, #00ff00 57.14%,
          #0000ff 57.14%, #0000ff 71.42%,
          #4b0082 71.42%, #4b0082 85.71%,
          #9400d3 85.71%, #9400d3 100%
        );
      background-size: 200% 100%;
      animation: rainbowMove 1s linear infinite;
      z-index: 1;
      opacity: 0.8;
      filter: brightness(1.2);
    }

    .music-control.playing .rainbow-trail {
      position: absolute;
      top: 50%;
      left: -150%;
      width: 300%;
      height: 4px;
      background: 
        linear-gradient(90deg, 
          #ff0000 0%, #ff0000 14.28%,
          #ff7f00 14.28%, #ff7f00 28.57%,
          #ffff00 28.57%, #ffff00 42.85%,
          #00ff00 42.85%, #00ff00 57.14%,
          #0000ff 57.14%, #0000ff 71.42%,
          #4b0082 71.42%, #4b0082 85.71%,
          #9400d3 85.71%, #9400d3 100%
        );
      background-size: 200% 100%;
      animation: rainbowMove 1s linear infinite;
      transform: translateY(-50%);
      filter: brightness(1.2) blur(1px);
      z-index: 0;
    }

    @keyframes nyanCat {
      0% { 
        transform: translateX(-2px) rotate(-5deg);
        filter: brightness(1.2) drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
      }
      25% { 
        transform: translateX(0px) rotate(0deg);
        filter: brightness(1) drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
      }
      50% { 
        transform: translateX(2px) rotate(5deg);
        filter: brightness(1.2) drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
      }
      75% { 
        transform: translateX(0px) rotate(0deg);
        filter: brightness(1) drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
      }
      100% { 
        transform: translateX(-2px) rotate(-5deg);
        filter: brightness(1.2) drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
      }
    }

    @keyframes rainbowMove {
      0% {
        background-position: 0% 50%;
        filter: hue-rotate(0deg);
      }
      100% {
        background-position: 200% 50%;
        filter: hue-rotate(360deg);
      }
    }

    /* –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–≤–µ–∑–¥—ã */
    .music-control.playing .stars {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(1px 1px at 25% 25%, white 100%, transparent 100%),
        radial-gradient(1px 1px at 50% 50%, white 100%, transparent 100%),
        radial-gradient(1px 1px at 75% 75%, white 100%, transparent 100%),
        radial-gradient(1px 1px at 15% 85%, white 100%, transparent 100%),
        radial-gradient(1px 1px at 85% 15%, white 100%, transparent 100%);
      background-size: 36px 36px;
      animation: twinkle 0.8s steps(2) infinite;
      filter: brightness(1.2);
      z-index: 1;
    }

    @keyframes twinkle {
      0%, 100% { 
        opacity: 0.3;
        transform: scale(0.8);
      }
      50% { 
        opacity: 0.8;
        transform: scale(1.2);
      }
    }
    
    .content {
      flex: 1;
      padding: 15px;
      padding-bottom: 25px;
      display: flex;
      flex-direction: column;
      overflow: auto;
      align-items: center;
    }
    
    .canvas-container {
      aspect-ratio: 1 / 1;
      width: 100%;
      max-width: 100%;
      max-height: 100%;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
      border-radius: 0;
      background: var(--grid-bg);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 0;
    }
    
    #pixelCanvas {
      width: 100%;
      height: 100%;
      display: block;
      border-radius: 0;
      image-rendering: pixelated;
    }
    
    #pixelCanvas.dragging {
      cursor: grabbing;
    }
    
    #pixelCanvas.selecting {
      cursor: pointer;
    }
    
    .controls {
      position: relative;
      z-index: 1;
      display: flex;
      justify-content: space-between; /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º space-between */
      margin-bottom: 10px;
      gap: 10px; /* –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
      margin-top: 10px;
      align-items: center;
      /* –£–±–∏—Ä–∞–µ–º flex-wrap */
      /* –£–±–∏—Ä–∞–µ–º justify-content: center */
    }
    
    .zoom-controls {
      display: flex;
      gap: 8px;
      background: rgba(255, 255, 255, 0.1);
      padding: 6px;
      border-radius: 30px;
      align-items: center;
      /* margin: 0 auto; */ /* –£–¥–∞–ª—è–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π margin */
    }
    
    .control-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.15);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }
    
    .control-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: scale(1.05);
    }

    .action-btn {
      padding: 8px 10px;
      border-radius: 20px;
      background: linear-gradient(to right, var(--accent-purple), white);
      color: var(--text-dark);
      font-size: 16px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      text-align: center;
      text-decoration: none;
      display: flex;
      justify-content: center;
      align-items: center;
      /* margin: 0 5px; */ /* –£–±–∏—Ä–∞–µ–º margin */
      /* flex-grow: 1; */ /* –£–±–∏—Ä–∞–µ–º flex-grow */
      /* flex-basis: 0; */ /* –£–±–∏—Ä–∞–µ–º flex-basis */
      width: auto; /* –®–∏—Ä–∏–Ω–∞ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –∏–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ–º—É –º–µ—Å—Ç—É */
      flex-shrink: 1; /* –ü–æ–∑–≤–æ–ª—è–µ–º —Å–∂–∏–º–∞—Ç—å—Å—è */
      max-width: 110px; /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
      height: 36px;
      white-space: nowrap;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .action-btn:hover {
      transform: translateY(-2px);
    }

    .action-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .action-btn span {
      background: linear-gradient(90deg, var(--farcaster-purple), white, var(--farcaster-purple));
      background-size: 200% 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientFlow 3s linear infinite;
      color: transparent;
    }

    .action-btn.share {
      background: linear-gradient(90deg, var(--farcaster-purple), white, var(--farcaster-purple));
      background-size: 200% 100%;
      animation: gradientFlow 3s linear infinite;
    }

    .action-btn.add-app {
      background: linear-gradient(90deg, var(--farcaster-purple), white, var(--farcaster-purple));
      background-size: 200% 100%;
      animation: gradientFlow 3s linear infinite;
    }
    
    .color-palette {
      position: relative;
      z-index: 1;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 15px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
    }
    
    .color {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 2px solid transparent;
    }
    
    .color:hover {
      transform: scale(1.1);
    }
    
    .color.selected {
      transform: scale(1.15);
      box-shadow: 0 0 0 3px white;
    }
    
    .draw-section {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    
    .selection-info {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
      font-size: 14px;
      margin-top: 10px;
      margin-bottom: 10px;
    }
    
    .pixel-coords {
      background: rgba(255, 255, 255, 0.1);
      padding: 5px 12px;
      border-radius: 20px;
    }
    
    .draw-btn {
      background: linear-gradient(90deg, var(--farcaster-purple), white, var(--farcaster-purple));
      background-size: 200% 100%;
      color: var(--text-dark);
      border: none;
      padding: 12px 30px;
      border-radius: 30px;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
      max-width: 300px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      animation: gradientFlow 3s linear infinite;
      /* outline: 2px solid red !important; */ /* –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –æ–±–≤–æ–¥–∫—É */
    }
    
    .draw-btn:hover {
      transform: translateY(-2px);
    }
    
    .counter {
      font-size: 14px;
      opacity: 0.9;
      margin-top: 5px;
      text-align: center;
      margin-bottom: 10px;
    }
    
    .counter span {
      font-weight: 600;
      color: var(--accent-yellow);
    }
    
    /* Leaderboard Styles */
    .leaderboard-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(26, 26, 46, 0.95);
      backdrop-filter: blur(10px);
      z-index: 10;
      display: flex;
      flex-direction: column;
      padding: 20px;
      transform: translateY(-100%);
      transition: transform 0.4s ease;
      border-radius: 20px;
    }
    
    .leaderboard-container.active {
      transform: translateY(0);
    }
    
    .leaderboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .leaderboard-title {
      font-size: 1.5rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .close-leaderboard {
      background: var(--farcaster-purple);
      color: white;
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .leaderboard-list {
      flex: 1;
      overflow-y: auto;
      padding-right: 5px;
    }
    
    .leaderboard-item {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      transition: all 0.2s ease;
    }
    
    .leaderboard-item:hover {
      background: rgba(124, 101, 193, 0.2);
      transform: translateX(5px);
    }
    
    .leaderboard-rank {
      font-weight: 700;
      width: 40px;
      min-width: 40px;
      text-align: center;
      font-size: 18px;
      padding-right: 10px;
    }
    
    .leaderboard-user {
      display: flex;
      align-items: center;
      flex: 1;
      gap: 12px;
    }
    
    .leaderboard-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(45deg, var(--farcaster-purple), var(--accent-yellow));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      flex-shrink: 0;
    }
    
    .leaderboard-pixels {
      background: var(--farcaster-purple);
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      flex-shrink: 0;
    }
    
    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--farcaster-purple);
      border-radius: 3px;
    }
    
    /* Responsive adjustments */
    @media (max-width: 424px) {
      .header {
        padding: 12px 15px;
      }
      
      .app-title {
        font-size: 1.1rem;
      }
      
      .leaderboard-btn {
        padding: 6px 12px;
        font-size: 13px;
      }
      
      .color {
        width: 28px;
        height: 28px;
      }
      
      .draw-btn {
        padding: 10px 20px;
        font-size: 15px;
      }
      
      .leaderboard-rank {
        width: 35px;
        min-width: 35px;
      }
    }
  </style>
</head>
<body>
  <div class="graffiti-background" id="graffitiBackground"></div>
  <!-- –î–æ–±–∞–≤–ª—è–µ–º –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç -->
  <audio id="backgroundMusic" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.ogg" type="audio/ogg">
    –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
  </audio>

  <div class="app-container">
    <div class="header">
      <div class="app-title">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%" gradientUnits="userSpaceOnUse">
              <stop offset="0%" style="stop-color: var(--farcaster-purple)">
                <animate attributeName="offset" values="0;1;0" dur="3s" repeatCount="indefinite"/>
              </stop>
              <stop offset="50%" style="stop-color: white">
                <animate attributeName="offset" values="0.5;1.5;0.5" dur="3s" repeatCount="indefinite"/>
              </stop>
              <stop offset="100%" style="stop-color: var(--farcaster-purple)">
                <animate attributeName="offset" values="1;2;1" dur="3s" repeatCount="indefinite"/>
              </stop>
            </linearGradient>
          </defs>
          <!-- Pixel logo inspired by Reddit Place (4x4 grid with gaps) -->
          <rect x="0.25" y="0.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="6.25" y="0.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="12.25" y="0.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="18.25" y="0.25" width="5.5" height="5.5" fill="url(#gradient)"/>

          <rect x="0.25" y="6.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="6.25" y="6.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="12.25" y="6.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="18.25" y="6.25" width="5.5" height="5.5" fill="url(#gradient)"/>

          <rect x="0.25" y="12.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="6.25" y="12.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="12.25" y="12.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="18.25" y="12.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          
          <rect x="0.25" y="18.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="6.25" y="18.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="12.25" y="18.25" width="5.5" height="5.5" fill="url(#gradient)"/>
          <rect x="18.25" y="18.25" width="5.5" height="5.5" fill="url(#gradient)"/>
        </svg>
        <span>Monad Place</span>
      </div>
      
      <div class="user-info">
        <div class="avatar" id="userAvatar">U</div>
        <button class="leaderboard-btn">
          üèÜ Leaderboard
        </button>
      </div>
    </div>
    
    <div class="content">
      <div class="counter">Total pixels drawn: <span id="pixelCounter">0</span></div>

      <div class="canvas-container">
        <canvas id="pixelCanvas"></canvas>
      </div>
      
      <div class="controls">
        <button class="action-btn add-app" title="–î–æ–±–∞–≤–∏—Ç—å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ">Add me!</button>
        <div class="zoom-controls">
          <div class="control-btn" id="zoomOut">‚àí</div>
          <div class="control-btn" id="zoomIn">+</div>
          <button class="control-btn music-control" id="musicControl" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É">‚ô™</button>
        </div>
        <button class="action-btn share" title="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è">Share me!</button>
      </div>
      
      <div class="color-palette" id="colorPalette">
        <!-- Colors will be added by JavaScript -->
      </div>
      
      <div class="selection-info">
        <div>Selected pixel:</div>
        <div class="pixel-coords" id="pixelCoords">None</div>
      </div>

      <div class="draw-section">
        <button class="draw-btn" id="drawBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          DRAW PIXEL
        </button>
      </div>
    </div>
    
    <div class="leaderboard-container" id="leaderboardContainer">
      <div class="leaderboard-header">
        <div class="leaderboard-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M16.5 18.5L21 14L16.5 9.5" stroke="#FFD700" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M7.5 9.5L3 14L7.5 18.5" stroke="#FFD700" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M13 6L11 18" stroke="#7c65c1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Pixel Leaders
        </div>
        <button class="close-leaderboard" id="closeLeaderboard">‚úï</button>
      </div>
      
      <div class="leaderboard-list" id="leaderboardList">
        <!-- Leaderboard items will be added by JavaScript -->
      </div>
    </div>
  </div>

  <script>
    // –î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º—É–∑—ã–∫–æ–π
    function setupMusicControl() {
      const music = document.getElementById('backgroundMusic');
      const musicControl = document.getElementById('musicControl');
      let isPlaying = false;
      let hasInteracted = false;

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –º—É–∑—ã–∫–∏
      function startMusic() {
        if (!hasInteracted) return; // –ù–µ –∑–∞–ø—É—Å–∫–∞–µ–º –º—É–∑—ã–∫—É –¥–æ –ø–µ—Ä–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
        
        music.volume = 0.5;
        const playPromise = music.play();
        
        if (playPromise !== undefined) {
          playPromise.then(() => {
            musicControl.classList.add('playing');
            isPlaying = true;
            // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            const rainbowTrail = document.createElement('div');
            rainbowTrail.className = 'rainbow-trail';
            const stars = document.createElement('div');
            stars.className = 'stars';
            musicControl.appendChild(rainbowTrail);
            musicControl.appendChild(stars);
          }).catch(error => {
            console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:", error);
            // –ü—Ä–æ–±—É–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞ –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.addEventListener('click', function tryPlayAgain() {
              music.play().then(() => {
                musicControl.classList.add('playing');
                isPlaying = true;
                // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                const rainbowTrail = document.createElement('div');
                rainbowTrail.className = 'rainbow-trail';
                const stars = document.createElement('div');
                stars.className = 'stars';
                musicControl.appendChild(rainbowTrail);
                musicControl.appendChild(stars);
                document.removeEventListener('click', tryPlayAgain);
              });
            }, { once: true });
          });
        }
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
      function handleFirstInteraction() {
        hasInteracted = true;
        startMusic();
        // –£–¥–∞–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
        document.removeEventListener('click', handleFirstInteraction);
        document.removeEventListener('touchstart', handleFirstInteraction);
      }

      // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
      document.addEventListener('click', handleFirstInteraction);
      document.addEventListener('touchstart', handleFirstInteraction);

      musicControl.addEventListener('click', (e) => {
        e.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è
        hasInteracted = true;
        
        if (isPlaying) {
          music.pause();
          musicControl.classList.remove('playing');
          isPlaying = false;
          // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∞–Ω–∏–º–∞—Ü–∏–∏
          const rainbowTrail = musicControl.querySelector('.rainbow-trail');
          const stars = musicControl.querySelector('.stars');
          if (rainbowTrail) rainbowTrail.remove();
          if (stars) stars.remove();
        } else {
          startMusic();
        }
      });

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞
      document.addEventListener('visibilitychange', () => {
        if (document.hidden && isPlaying) {
          music.pause();
        } else if (!document.hidden && isPlaying) {
          music.play();
        }
      });
    }

    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    const GRID_SIZE = 200; // 200x200 –ø–∏–∫—Å–µ–ª–µ–π
    let boardSize = 1; // —Ä–∞–∑–º–µ—Ä canvas (px), –≤—Å–µ–≥–¥–∞ –∫–≤–∞–¥—Ä–∞—Ç
    let pixelSize = 1; // —Ä–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –ø–∏–∫—Å–µ–ª—è (px), –≤—Å–µ–≥–¥–∞ –∫–≤–∞–¥—Ä–∞—Ç
    const COLORS = [
      '#FFD700', // –∂–µ–ª—Ç—ã–π
      '#7c65c1', // —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π Farcaster
      '#FFFFFF', // –±–µ–ª—ã–π
      '#FF5733', // –æ—Ä–∞–Ω–∂–µ–≤—ã–π
      '#33FF57', // –∑–µ–ª–µ–Ω—ã–π
      '#3357FF', // —Å–∏–Ω–∏–π
      '#F333FF', // —Ä–æ–∑–æ–≤—ã–π
      '#000000'  // —á–µ—Ä–Ω—ã–π
    ];
    
    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    let scale = 1;
    let offsetX = 0;
    let offsetY = 0;
    let isDragging = false;
    let lastX, lastY;
    let selectedColor = COLORS[0];
    let selectedPixel = {x: -1, y: -1};
    let pixelCount = 0;
    let userPixels = 0;
    let gridState = {};
    let canvas, ctx, container;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    function init() {
      // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
      canvas = document.getElementById('pixelCanvas');
      ctx = canvas.getContext('2d');
      container = document.querySelector('.canvas-container');
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas –∏ –ø–∏–∫—Å–µ–ª—è
      recalcCanvasSize();
      
      // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞–ª–∏—Ç—Ä—ã —Ü–≤–µ—Ç–æ–≤
      setupColorPalette();
      
      // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
      setupEventListeners(canvas);
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–∂–∏–º –≤—ã–±–æ—Ä–∞ –ø–∏–∫—Å–µ–ª—è
      canvas.classList.add('selecting');
      
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—É—Å—Ç—É—é —Å–µ—Ç–∫—É
      drawGrid(ctx);
      
      // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è
      resetView();
      
      // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–∫–Ω–∞
      window.addEventListener('resize', () => {
        recalcCanvasSize();
        drawGrid(ctx);
        updateCanvasTransform();
      });
    }
    
    // –ü–µ—Ä–µ—Å—á—ë—Ç —Ä–∞–∑–º–µ—Ä–∞ canvas –∏ –ø–∏–∫—Å–µ–ª—è
    function recalcCanvasSize() {
      canvas.style.width = '100%';
      canvas.style.height = '100%';
      let rawSize = canvas.offsetWidth;
      boardSize = Math.floor(rawSize / GRID_SIZE) * GRID_SIZE;
      canvas.width = boardSize;
      canvas.height = boardSize;
    }
    
    // –°–±—Ä–æ—Å –≤–∏–¥–∞ –∫ –ø–æ–ª–Ω–æ–º—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é —Å–µ—Ç–∫–∏
    function resetView() {
      scale = 1;
      offsetX = 0;
      offsetY = 0;
      updateCanvasTransform();
    }
    
    // –†–∏—Å—É–µ–º —Å–µ—Ç–∫—É
    function drawGrid(ctx) {
      // –û—á–∏—â–∞–µ–º –≤–µ—Å—å canvas –ø–µ—Ä–µ–¥ –æ—Ç—Ä–∏—Å–æ–≤–∫–æ–π
      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
      
      // –†–∏—Å—É–µ–º –±–æ–ª–µ–µ —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –≤—Å–µ–π –æ–±–ª–∞—Å—Ç–∏
      ctx.fillStyle = 'rgba(43, 43, 68, 0.8)'; // –û—Å—Ç–∞–≤–ª—è–µ–º —Ñ–æ–Ω –∫–∞–∫ –µ—Å—Ç—å
      ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
      
      // –†–∏—Å—É–µ–º –±–æ–ª–µ–µ —Å–≤–µ—Ç–ª—ã–π —Ñ–æ–Ω –¥–ª—è —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏ 200x200
      ctx.fillStyle = 'rgba(40, 40, 60, 0.8)'; // –î–µ–ª–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –æ–±–ª–∞—Å—Ç—å —á—É—Ç—å —Å–≤–µ—Ç–ª–µ–µ
      const pixelSize = boardSize / GRID_SIZE;
      const workingAreaSize = GRID_SIZE * pixelSize;
      ctx.fillRect(0, 0, workingAreaSize, workingAreaSize);
      
      // –†–∏—Å—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏
      for (let x = 0; x < GRID_SIZE; x++) {
        for (let y = 0; y < GRID_SIZE; y++) {
          const x0 = Math.round(x * pixelSize);
          const y0 = Math.round((GRID_SIZE - 1 - y) * pixelSize);
          const x1 = Math.round((x + 1) * pixelSize);
          const y1 = Math.round((GRID_SIZE - y) * pixelSize);
          
          if (y1 > y0 && x1 > x0) {
            const key = `${x}:${y}`;
            if (gridState[key]) {
              ctx.fillStyle = gridState[key];
              ctx.fillRect(x0, y0, x1 - x0, y1 - y0);
            }
          }
        }
      }
      
      // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–∏–∫—Å–µ–ª—å –ü–û–°–õ–ï –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–µ—Ç–∫–∏
      if (selectedPixel.x >= 0 && selectedPixel.y >= 0) {
        ctx.fillStyle = '#808080';
        const x0 = Math.round(selectedPixel.x * pixelSize);
        const y0 = Math.round((GRID_SIZE - 1 - selectedPixel.y) * pixelSize);
        const x1 = Math.round((selectedPixel.x + 1) * pixelSize);
        const y1 = Math.round((GRID_SIZE - selectedPixel.y) * pixelSize);
        
        if (y1 > y0 && x1 > x0) {
          ctx.fillRect(x0, y0, x1 - x0, y1 - y0);
        }
      }

      // –†–∏—Å—É–µ–º —Ç–æ–Ω–∫—É—é —Å–µ—Ä—É—é —Ä–∞–º–∫—É –≤–æ–∫—Ä—É–≥ –æ–±–ª–∞—Å—Ç–∏ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
      ctx.fillStyle = '#808080';
      const frameThicknessCanvas = 1;

      // –í–µ—Ä—Ö–Ω—è—è –ª–∏–Ω–∏—è
      ctx.fillRect(-frameThicknessCanvas, -frameThicknessCanvas, workingAreaSize + frameThicknessCanvas * 2, frameThicknessCanvas);
      // –ù–∏–∂–Ω—è—è –ª–∏–Ω–∏—è
      ctx.fillRect(-frameThicknessCanvas, workingAreaSize, workingAreaSize + frameThicknessCanvas * 2, frameThicknessCanvas);
      // –õ–µ–≤–∞—è –ª–∏–Ω–∏—è
      ctx.fillRect(-frameThicknessCanvas, -frameThicknessCanvas, frameThicknessCanvas, workingAreaSize + frameThicknessCanvas * 2);
      // –ü—Ä–∞–≤–∞—è –ª–∏–Ω–∏—è
      ctx.fillRect(workingAreaSize, -frameThicknessCanvas, frameThicknessCanvas, workingAreaSize + frameThicknessCanvas * 2);
    }
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–∞–ª–∏—Ç—Ä—É —Ü–≤–µ—Ç–æ–≤
    function setupColorPalette() {
      const palette = document.getElementById('colorPalette');
      palette.innerHTML = '';
      
      COLORS.forEach((color, index) => {
        const colorEl = document.createElement('div');
        colorEl.className = 'color';
        colorEl.style.backgroundColor = color;
        colorEl.dataset.color = color;
        colorEl.dataset.index = index;
        
        if (color === selectedColor) {
          colorEl.classList.add('selected');
          // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ –º—É–∑—ã–∫–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
          updateMusicButtonColor(color);
        }
        
        colorEl.addEventListener('click', () => {
          document.querySelectorAll('.color').forEach(el => {
            el.classList.remove('selected');
          });
          colorEl.classList.add('selected');
          selectedColor = color;
          // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ –º—É–∑—ã–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –Ω–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞
          updateMusicButtonColor(color);
        });
        
        palette.appendChild(colorEl);
      });
    }

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ –∫–Ω–æ–ø–∫–∏ –º—É–∑—ã–∫–∏
    function updateMusicButtonColor(color) {
      const musicControl = document.getElementById('musicControl');
      if (!musicControl.classList.contains('playing')) {
        musicControl.style.backgroundColor = 'rgba(255, 255, 255, 0.15)';
        musicControl.style.color = '#ffffff';
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ HEX –≤ RGB
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : null;
    }
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    function setupEventListeners(canvas) {
      // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
      document.getElementById('zoomIn').addEventListener('click', () => zoom(1.0));
      document.getElementById('zoomOut').addEventListener('click', () => zoom(-1.0));

      // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–æ canvas
      canvas.addEventListener('mousedown', startDrag);
      canvas.addEventListener('touchstart', startDragTouch, { passive: false });

      canvas.addEventListener('mousemove', drag);
      canvas.addEventListener('touchmove', dragTouch, { passive: false });

      canvas.addEventListener('mouseup', endDrag);
      canvas.addEventListener('mouseleave', endDrag);
      canvas.addEventListener('touchend', endDrag);

      // –í—ã–±–æ—Ä –ø–∏–∫—Å–µ–ª—è
      canvas.addEventListener('click', selectPixel);
      canvas.addEventListener('touchstart', selectPixelTouch, { passive: false });

      // –ö–Ω–æ–ø–∫–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
      document.getElementById('drawBtn').addEventListener('click', drawPixel);

      // –ö–Ω–æ–ø–∫–∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
      document.querySelector('.leaderboard-btn').addEventListener('click', showLeaderboard);
      document.getElementById('closeLeaderboard').addEventListener('click', hideLeaderboard);
    }
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ drag/endDrag/startDrag –∏ selectPixel/selectPixelTouch
    function startDrag(e) {
      if (scale <= 1) return;
      e.preventDefault();
      isDragging = true;
      lastX = e.clientX;
      lastY = e.clientY;
      canvas.classList.remove('selecting');
      canvas.classList.add('dragging');
    }
    function startDragTouch(e) {
      if (scale <= 1) return;
      if (e.touches.length === 1) {
        e.preventDefault();
        isDragging = true;
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
        canvas.classList.remove('selecting');
        canvas.classList.add('dragging');
      }
    }
    function drag(e) {
      if (!isDragging || scale <= 1) return;
      e.preventDefault();
      const deltaX = e.clientX - lastX;
      const deltaY = e.clientY - lastY;
      lastX = e.clientX;
      lastY = e.clientY;
      offsetX += deltaX / scale;
      offsetY += deltaY / scale;
      updateCanvasTransform();
    }
    function dragTouch(e) {
      if (!isDragging || e.touches.length !== 1 || scale <= 1) return;
      e.preventDefault();
      const deltaX = e.touches[0].clientX - lastX;
      const deltaY = e.touches[0].clientY - lastY;
      lastX = e.touches[0].clientX;
      lastY = e.touches[0].clientY;
      offsetX += deltaX / scale;
      offsetY += deltaY / scale;
      updateCanvasTransform();
    }
    function endDrag() {
      if (!isDragging) return;
      isDragging = false;
      canvas.classList.remove('dragging');
      canvas.classList.add('selecting');
    }
    // –í—ã–±–æ—Ä –ø–∏–∫—Å–µ–ª—è
    function selectPixel(e) {
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      const canvasX = (e.clientX - rect.left) * scaleX;
      const canvasY = (e.clientY - rect.top) * scaleY;

      const pixelSize = boardSize / GRID_SIZE;
      const yIndexRaw = canvasY / pixelSize;
      const y = Math.min(GRID_SIZE - 1 - Math.floor(yIndexRaw), GRID_SIZE - 1);
      const x = Math.min(Math.floor(canvasX / pixelSize), GRID_SIZE - 1);

      if (x >= 0 && x < GRID_SIZE && y >= 0 && y < GRID_SIZE) {
        selectedPixel = {x, y};
        document.getElementById('pixelCoords').textContent = `(${x}, ${y})`;
        drawGrid(ctx);
      }
    }
    // –í—ã–±–æ—Ä –ø–∏–∫—Å–µ–ª—è –¥–ª—è –∫–∞—Å–∞–Ω–∏—è
    function selectPixelTouch(e) {
      if (e.touches.length === 1) {
        selectPixel(e.touches[0]);
      }
    }

    // –†–∏—Å–æ–≤–∞–Ω–∏–µ –ø–∏–∫—Å–µ–ª—è
    function drawPixel() {
      if (selectedPixel.x < 0 || selectedPixel.y < 0) {
        alert("Please select a pixel first!");
        return;
      }

      // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ Solana
      // –ü–û–ú–ï–¢–ö–ê: –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
      // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫
      const success = true; // –í –¥–µ–º–æ –≤—Å–µ–≥–¥–∞ —É—Å–ø–µ—à–Ω–æ

      if (success) {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∏–∫—Å–µ–ª—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏
        const key = `${selectedPixel.x}:${selectedPixel.y}`;
        gridState[key] = selectedColor;

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ—Ç–∫—É - –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å –∑–∞–∫—Ä–∞—à–µ–Ω–Ω—ã–º –ø–∏–∫—Å–µ–ª–µ–º –∏ —Ç–µ–∫—É—â–∏–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º
        const canvas = document.getElementById('pixelCanvas'); // –ü–æ–ª—É—á–∞–µ–º canvas —Å–Ω–æ–≤–∞ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
        const ctx = canvas.getContext('2d'); // –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–Ω–æ–≤–∞ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)

        drawGrid(ctx);

        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
        pixelCount++;
        userPixels++;
        document.getElementById('pixelCounter').textContent = pixelCount;
      }
    }
    
    // –õ–∏–¥–µ—Ä–±–æ—Ä–¥
    function showLeaderboard() {
      document.getElementById('leaderboardContainer').classList.add('active');
    }
    
    function hideLeaderboard() {
      document.getElementById('leaderboardContainer').classList.remove('active');
    }
    
    function generateLeaderboard() {
      const leaderboard = [
        { username: 'solanafan', pixels: 142 },
        { username: 'pixel_man', pixels: 98 },
        { username: 'cryptowiz', pixels: 76 },
        { username: 'xmoonx', pixels: 65 },
        { username: 'annaxco', pixels: 54 },
        { username: 'roxgushero', pixels: 43 },
        { username: 'mftcollector', pixels: 32 },
        { username: 'seekeetkuo', pixels: 21 },
        { username: 'blockchainer', pixels: 18 },
        { username: 'web3artist', pixels: 15 }
      ];
      
      const list = document.getElementById('leaderboardList');
      list.innerHTML = '';
      
      leaderboard.forEach((user, index) => {
        const item = document.createElement('div');
        item.className = 'leaderboard-item';
        
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏
        const rank = document.createElement('div');
        rank.className = 'leaderboard-rank';
        rank.textContent = `#${index + 1}`;
        
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        const userInfo = document.createElement('div');
        userInfo.className = 'leaderboard-user';
        
        // –ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const avatar = document.createElement('div');
        avatar.className = 'leaderboard-avatar';
        avatar.textContent = user.username.charAt(0).toUpperCase();
        
        // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const name = document.createElement('div');
        name.textContent = user.username;
        
        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏–∫—Å–µ–ª–µ–π
        const pixels = document.createElement('div');
        pixels.className = 'leaderboard-pixels';
        pixels.textContent = `${user.pixels} pixels`;
        
        // –°–æ–±–∏—Ä–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        userInfo.appendChild(avatar);
        userInfo.appendChild(name);
        
        // –°–æ–±–∏—Ä–∞–µ–º –≤–µ—Å—å —ç–ª–µ–º–µ–Ω—Ç –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
        item.appendChild(rank);
        item.appendChild(userInfo);
        item.appendChild(pixels);
        
        list.appendChild(item);
      });
    }
    
    // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function simulateUserAuth() {
      const usernames = ['solanafan', 'pixelmaster', 'cryptoartist', 'web3creator'];
      const username = usernames[Math.floor(Math.random() * usernames.length)];
      
      document.getElementById('userAvatar').textContent = username.charAt(0).toUpperCase();
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('load', () => {
      init();
      simulateUserAuth();
      generateLeaderboard();
      setupMusicControl();
    });

    // –§—É–Ω–∫—Ü–∏–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
    function zoom(delta) {
      const newScale = scale + delta;
      if (newScale < 1) return;
      if (newScale > 20) return; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –º–∞—Å—à—Ç–∞–± 20
      scale = newScale;
      updateCanvasTransform();
    }

    function updateCanvasTransform() {
      // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏—è
      const maxPan = Math.max(0, (boardSize * scale - boardSize) / 2);

      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Å–º–µ—â–µ–Ω–∏—è
      offsetX = Math.max(-maxPan, Math.min(offsetX, maxPan));
      offsetY = Math.max(-maxPan, Math.min(offsetY, maxPan));

      // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Å—à—Ç–∞–± –∫ —Å–∞–º–æ–º—É canvas –≤–º–µ—Å—Ç–æ CSS-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
      canvas.width = boardSize;
      canvas.height = boardSize;

      // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å–µ—Ç–∫—É —Å –Ω–æ–≤—ã–º –º–∞—Å—à—Ç–∞–±–æ–º
      drawGrid(ctx);

      // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–º–µ—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ CSS
      canvas.style.transform = `scale(${scale}) translate(${offsetX}px, ${offsetY}px)`;
    }
  </script>
</body>
</html>
